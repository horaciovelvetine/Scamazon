<div class="container-fluid">

<div class="d-flex flex-row px-3 pt-3 align-items-end">
    
    <div class="flex-fill">
        <div class="fs-6 lh-1 lead"><%= @results.length %> of <%= @results.length %> results for <span class="fw-bold">"<%= @search.query %>"</span></div>
    </div>
    
    <div class="">
    <%= form_with url:"/search/:id/sort_by", method:"POST" do |f| %>
        <%= fields_for :dropdown_button do |form| %>
            <%= form.select :option, [["Featured", "Featured"], ["Price: Low to High","Price:LH"], ["Price: High to Low", "Price:HL"], ["Avg. Customer Review", "AvgReview"], ["Newest Arrivals", "New"]], selected:"Featured",  data_toggle:"dropdown", aria_expanded:"false" %>
        <% end %>
    </div>
</div>

<hr>

<div class="d-flex flex-row">
    <div class="col-2 px-3" >
    <div class="border-end mx-1 border-2">
    <%= fields_for :sidebar do |form| %>
        
        <div class="row">
            <div class="fs-6 text-start fw-bolder lh-sm">Eligible for Free Shipping</div>
        </div>

        <div class="row">
            <div class="col py-2">
                <%= form.check_box :Free_Shipping_by_Scamazon, class:"form-check-input" %>
                <span class="fs-6">Free shipping by Scamazon</span>
            </div>
        </div>

        <div class="row px-2">
            <div class="col fs-6 lh-1 text-start pb-1"><small>All customers get FREE shipping on orders over $24 shipped by Scamazon</small></div>
        </div>
        

        <div class="row py-2">
            <div class="col fs-6 text-start fw-bolder lh-sm">Delivery Day</div>
        </div>

        <div class="row">
            <div class="col py-1">
                <%= form.check_box :Delivered_Tomorrow, class:"form-check-input" %>
                <span class="fs-6">Get it by Tomorrow</span>
            </div>
        </div>
        

        <div class="row">
            <% @categorys = @search.relevant_categories(@search) %>
            <div class="col">
                <div class="accordion accordion-flush ms-0 mb-2" id="accordionFlushExample">
                    <div class="accordion-item  text-start">
                        <div class="accordion-header" id="flush-headingOne">
                        <button class="accordion-button collapsed text-start" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne"> 
                            <div class="col fs-6 fw-bolder">Categories</div>
                        </button>
                        </div>
                        <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                            <div class="accordion-body">
                                <ul>
                                    <% @categorys.each do |category| %>
                                    <div class="fs-6 text-start"><%= link_to category.name, root_path %></div>
                                    <% end %>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <% end %>
        </div>

        <div class="row py-1">
            <div class="fs-6 text-start fw-bolder lh-sm">Customer Reviews</div>
        </div>
        <div class="row">
            <div class="col ms-1 mb-2">
                <%= link_to render('/item/ratings/sort_by/1_star'), root_path, class:"text-decoration-none" %> <small> & Up</small><br>
                <%= link_to render('/item/ratings/sort_by/2_star'), root_path, class:"text-decoration-none" %> <small> & Up</small><br>
                <%= link_to render('/item/ratings/sort_by/3_star'), root_path, class:"text-decoration-none" %> <small> & Up</small><br>
                <%= link_to render('/item/ratings/sort_by/4_star'), root_path, class:"text-decoration-none" %> <small> & Up</small><br>
                <%= link_to render('/item/ratings/sort_by/5_star'), root_path, class:"text-decoration-none" %> <small> & Up</small><br>
                
            </div>
        </div>

        <div class="row py-2">
            <div class="fs-6 text-start fw-bolder lh-sm">Price</div>
        </div>
        <div class="row">
            <div class="col">
                <ul>
                    <div><%= link_to "Up to $25", root_path %></div>
                    <div><%= link_to "$100 to $200", root_path %></div>
                    <div><%= link_to "$200 & Up", root_path %></div>
                </ul>

            </div>
        </div>
    </div>
        <div class="row">
            <div class="col">
                <div class="actions mt-5">
                    <%= f.submit "Sort", class:"btn btn-outline-primary w-100" %>
                </div>
            </div>
        </div>
    <% end %>
    </div>

    <div class="col-10">
        <div class="row">
            <div class="text-start tex-muted fs-6 lh-1"><small><em>Price and other details may vary based on product size and color.</em></small>
        </div>
      <div class="row g-0 lh-1">
      <% @results.each do |item| %>
        <% set_item(item) %>
        <div class="col-3 text-start lh-1">
          <%= link_to render(:partial => '/searches/shared/components/search_result_single_card'), item_path(@item), class:"btn btn-link flex-fill" %><div class="border-bottom border-2 mx-4 my-2"></div>
        </div>
      <% end %>
      </div>
    </div>

  </div>

<div class="mt-5 mb-3">
    <%= render "/item/shared/explore_more_items"%>
</div>

